import{u as w,s as g,o as D,x as S,y as N,I as b,D as $,R as E,G as k,S as M,W as O}from"./index.9ce0a29e.js";import{k as P,r as B,j as l,q as i,v as _,u as n,F as T,I as A}from"./@vuelidate.e7200945.js";const G=P({__name:"AddToCartButton",props:{project:null},setup(j){const a=j,u=B(S.toString()),o=w(),{currentRound:r,cart:x}=g(o),y=D(),{currentUser:s}=g(y),I=B(!1),c=l(()=>x.value.findIndex(t=>t.id===a.project.id&&!t.isCleared)!==-1),R=l(()=>S),d=l(()=>N(u.value,r.value));function p(){return!!r.value&&a.project.index!==0}function m(){return p()&&!!r.value&&$.local()<r.value.votingDeadline&&r.value.status!==E.Cancelled&&a.project.isHidden===!1&&a.project.isLocked===!1}function f(){o.addCartItem({...a.project,amount:u.value,isCleared:!1}),o.saveCart(),o.toggleEditSelection(!0),o.toggleShowCartPanel(!0)}function U(){if(p()&&s.value){s.value.encryptionKey?f():C();return}V()}function C(){const{open:e,close:t}=k({component:M,attrs:{onClose(){t().then(()=>{s.value?.encryptionKey&&f()})}}});e()}function V(){const{open:e,close:t}=k({component:O,attrs:{onClose(){t().then(()=>{s.value?.walletAddress&&C()})}}});e()}function h(){o.toggleShowCartPanel(!0)}return(e,t)=>(i(),_("div",null,[!n(c)&&m()?(i(),T(b,{key:0,modelValue:n(u),input:{placeholder:n(R).toString(),class:`{ invalid: ${!n(d)} }`},button:{text:e.$t("addToCartButton.input1"),disabled:!n(d)||n(I)},"onUpdate:modelValue":t[0]||(t[0]=v=>u.value=v),onClick:U},null,8,["modelValue","input","button"])):A("",!0),n(c)&&m()?(i(),T(b,{key:1,button:{wide:!0,text:e.$t("addToCartButton.input2")},onClick:t[1]||(t[1]=v=>h())},null,8,["button"])):A("",!0)]))}});export{G as _};
