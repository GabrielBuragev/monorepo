import{b as D,a as B,F as K,H as W,J as X,u as V,s as T,o as J,K as Y,L as z,M as ee,N as te,n as O,G as oe,k as ne,R as ae,r as se,O as le,c as F,g as ce,P as re}from"./index.9ce0a29e.js";import{k as I,q as a,v as r,a1 as $,J as o,A as q,B as Z,C as t,j as R,u as i,K as j,G as x,I as c,r as k,H as E,F as A,w as ie,z as ue}from"./@vuelidate.e7200945.js";import{_ as M}from"./Markdown.5d3f9ab7.js";import{_ as de}from"./AddToCartButton.vue_vue_type_script_setup_true_lang.8d4e28f4.js";import{C as Q,d as me}from"./maci.f28b6353.js";import{B as pe}from"./@kleros/gtcr-encoder.75dc8b9f.js";const ve=e=>(q("data-v-4d017c74"),e=e(),Z(),e),_e={class:"info"},je=ve(()=>t("span",{class:"icon","aria-label":"info icon"},"\u2139",-1)),he=I({__name:"Info",props:{message:null},setup(e){return(n,u)=>(a(),r("div",_e,[je,$(" "+o(e.message),1)]))}});const fe=D(he,[["__scopeId","data-v-4d017c74"]]),ke=""+new URL("GitHub.7367d16f.svg",import.meta.url).href,ye=""+new URL("Twitter.32362ee3.svg",import.meta.url).href,ge=""+new URL("Meridians.bbb3a21c.svg",import.meta.url).href,G=e=>(q("data-v-99cc9c71"),e=e(),Z(),e),be={key:0,class:"link-box"},$e={class:"link-title"},we={key:0,class:"link-row"},Ce=G(()=>t("img",{src:ke},null,-1)),Re={key:1,class:"link-row"},Ae=G(()=>t("img",{src:ye},null,-1)),xe={key:2,class:"link-row"},Ue=G(()=>t("img",{src:ge},null,-1)),Be=I({__name:"LinkBox",props:{project:null},setup(e){const n=e,u=R(()=>Boolean(n.project.websiteUrl||n.project.twitterUrl||n.project.githubUrl));return(s,v)=>i(u)?(a(),r("div",be,[t("h2",$e,o(s.$t("linkBox.h2")),1),e.project.githubUrl?(a(),r("div",we,[Ce,j(B,{to:e.project.githubUrl},{default:x(()=>[$(o(s.$t("linkBox.link1")),1)]),_:1},8,["to"])])):c("",!0),e.project.twitterUrl?(a(),r("div",Re,[Ae,j(B,{to:e.project.twitterUrl},{default:x(()=>[$(o(s.$t("linkBox.link2")),1)]),_:1},8,["to"])])):c("",!0),e.project.websiteUrl?(a(),r("div",xe,[Ue,j(B,{to:e.project.websiteUrl},{default:x(()=>[$(o(e.project.websiteUrl),1)]),_:1},8,["to"])])):c("",!0)])):c("",!0)}});const Pe=D(Be,[["__scopeId","data-v-99cc9c71"]]);async function Se(e,n,u,s){return await new Q(e,K,W).getAllocatedAmount(u,s)}async function De(e,n,u){return!!(await X.GetRecipientDonations({fundingRoundAddress:e.toLowerCase(),recipientAddress:n,recipientIndex:u})).donations.length}const Ie={class:"modal-body"},Le={key:0},Me={key:1},Te={class:"address-box"},Ne={class:"address-label"},Fe={class:"address"},Ve=I({__name:"ClaimModal",props:{project:null,claimed:{type:Function}},emits:["close"],setup(e,{emit:n}){const u=e,s=V(),{currentRound:v,tally:U}=T(s),P=J(),y=k(1),m=k(""),_=k(""),h=k(pe.from(0)),f=k("");function w(d){const{nativeTokenDecimals:p}=v.value;return O(d,p)}E(()=>{C()});async function C(){const d=P.signer,{fundingRoundAddress:p,recipientTreeDepth:g}=v.value,l=new Q(p,K,d),L=me(u.project.index,g,U.value);let S;try{S=await Y(l.claimFunds(...L),b=>m.value=b)}catch(b){_.value=b.message;return}h.value=z(S,l,"FundsClaimed","_amount"),f.value=z(S,l,"FundsClaimed","_recipient"),u.claimed(),y.value+=1}return(d,p)=>(a(),A(i(te),{class:"modal-container"},{default:x(()=>[t("div",Ie,[y.value===1?(a(),r("div",Le,[t("h2",null,o(d.$t("claimModal.h2_1")),1),j(ee,{hash:m.value,error:_.value,onClose:p[0]||(p[0]=g=>n("close"))},null,8,["hash","error"])])):c("",!0),y.value===2?(a(),r("div",Me,[t("h2",null,o(d.$t("claimModal.h2_2")),1),t("p",null,[t("strong",null,o(w(h.value))+" "+o(i(v)?.nativeTokenSymbol),1),$(" "+o(d.$t("claimModal.p1")),1)]),t("div",Te,[t("div",null,[t("div",Ne,o(d.$t("claimModal.div1")),1),t("div",Fe,o(f.value),1)])]),t("button",{class:"btn-primary",onClick:p[1]||(p[1]=g=>n("close"))},o(d.$t("claimModal.button1")),1)])):c("",!0)])]),_:1}))}});const Ee=D(Ve,[["__scopeId","data-v-4baeff3b"]]),Ge={key:1},He=["disabled"],ze=I({__name:"ClaimButton",props:{project:null},setup(e){const n=e,u=V(),{currentRound:s,tally:v,isRoundFinalized:U}=T(u),P=J(),{currentUser:y}=T(P),m=k(null),_=k(null),h=k(!0),f=R(()=>s.value?.nativeTokenSymbol??"");E(()=>{w()}),ie(s,()=>{w()});async function w(){if(!n.project||!s.value||!U.value||m.value){h.value=!1;return}h.value=!0,v.value||await C(),m.value=await Se(s.value.fundingRoundAddress,s.value.nativeTokenDecimals,v.value.results.tally[n.project.index],v.value.totalVoiceCreditsPerVoteOption.tally[n.project.index]),_.value=await De(s.value.fundingRoundAddress,n.project.address,n.project.index),h.value=!1}async function C(){await u.loadTally()}function d(){return!!s.value&&s.value.status===ae.Finalized&&n.project!==null&&n.project.index!==0&&!n.project.isHidden&&m.value!==null&&!m.value.isZero()&&_.value!==null}function p(){return d()&&!!y.value&&!_.value}function g(b){const{nativeTokenDecimals:H}=s.value;return O(b,H,null,6)}const{open:l,close:L}=oe({component:Ee,attrs:{project:n.project,claimed(){_.value=!0},onClose(){L()}}});function S(){l()}return(b,N)=>(a(),r("div",null,[h.value?(a(),A(ne,{key:0})):c("",!0),_.value&&m.value!==null?(a(),r("p",Ge,o(b.$t("claimButton.p",{allocatedAmount:g(m.value),tokenSymbol:i(f)})),1)):c("",!0),d()&&!_.value&&m.value!==null?(a(),r("button",{key:2,class:"btn-action",disabled:!p(),onClick:N[0]||(N[0]=H=>S())},o(b.$t("claimButton.button",{allocatedAmount:g(m.value),tokenSymbol:i(f)})),9,He)):c("",!0)]))}});const Ke=D(ze,[["__scopeId","data-v-88a18dc5"]]),Je={key:0,class:"project-page"},Oe=["src","alt"],qe={class:"about"},Ze=["title","project-index"],Qe={key:1},We={class:"tagline"},Xe={class:"subtitle"},Ye={key:0,class:"tag"},et={key:1,class:"team-byline"},tt={class:"mobile mb2"},ot={key:2},nt={class:"project-section"},at={class:"project-section"},st={class:"project-section"},lt={class:"address-label"},ct={class:"address"},rt={class:"copy-div"},it=["src"],ut={key:0},dt={key:1,id:"team",class:"team"},mt=I({__name:"ProjectProfile",props:{project:null,klerosCurateUrl:null,previewMode:{type:Boolean}},setup(e){const n=e,u=se(),s=V(),{currentRound:v,currentRoundAddress:U,isRoundContributionPhase:P,canUserReallocate:y,hasUserContributed:m,categoryLocaleKey:_}=T(s),h=k(null);E(async()=>{n.project.address&&(h.value=await le(n.project.address))});const f=R(()=>({label:F.explorerLabel,url:`${F.explorer}/address/${n.project.address}`,logo:F.explorerLogo})),w=R(()=>h.value||n.project.address),C=R(()=>{const l=u.params.address||U.value;return s.isCurrentRound(l)}),d=R(()=>C.value&&(P.value||y.value)),p=R(()=>ce(f.value.logo));function g(){return C.value&&v.value&&n.project!==null&&n.project.index!==0}return(l,L)=>e.project?(a(),r("div",Je,[e.previewMode?(a(),A(fe,{key:0,class:"info",message:l.$t("projectProfile.info1")},null,8,["message"])):c("",!0),e.previewMode?(a(),r("img",{key:1,class:"project-image",src:e.project.bannerImageUrl,alt:e.project.name},null,8,Oe)):c("",!0),t("div",qe,[t("h1",{class:"project-name",title:i(w),"project-index":e.project.index},[e.klerosCurateUrl?(a(),A(B,{key:0,to:e.klerosCurateUrl},{default:x(()=>[$(o(e.project.name),1)]),_:1},8,["to"])):(a(),r("span",Qe,o(e.project.name),1))],8,Ze),t("p",We,o(e.project.tagline),1),t("div",Xe,[e.project.category?(a(),r("div",Ye,o(l.$t(i(_)(e.project.category)))+" "+o(l.$t("projectProfile.div1")),1)):c("",!0),e.project.teamName?(a(),r("div",et,[$(o(l.$t("projectProfile.div2"))+" ",1),j(B,{to:"#team"},{default:x(()=>[$(o(e.project.teamName),1)]),_:1})])):c("",!0)]),t("div",tt,[i(d)&&g()?(a(),A(de,{key:0,project:e.project},null,8,["project"])):c("",!0),i(C)?(a(),A(Ke,{key:1,project:e.project},null,8,["project"])):c("",!0),i(m)&&!i(y)?(a(),r("p",ot,o(l.$t("projectProfile.p1")),1)):c("",!0)]),t("div",nt,[t("h2",null,o(l.$t("projectProfile.h2_1")),1),j(M,{raw:e.project.description},null,8,["raw"])]),t("div",at,[t("h2",null,o(l.$t("projectProfile.h2_2")),1),j(M,{raw:e.project.problemSpace||""},null,8,["raw"])]),t("div",st,[t("h2",null,o(l.$t("projectProfile.h2_3")),1),j(M,{raw:e.project.plans||""},null,8,["raw"])]),t("div",{class:ue({"address-box":e.project.teamName||e.project.teamDescription,"address-box-no-team":!e.project.teamName&&!e.project.teamDescription})},[t("div",null,[t("div",lt,o(l.$t("projectProfile.div3")),1),t("div",ct,o(i(w)),1)]),t("div",rt,[j(re,{value:e.project.address,text:l.$t("projectProfile.button1"),myClass:"project-profile",hasBorder:!0},null,8,["value","text"]),j(B,{class:"explorerLink",to:i(f).url,title:l.$t("projectProfile.link1",{blockExplorer:i(f).label}),hideArrow:!0},{default:x(()=>[t("img",{class:"icon",src:i(p)},null,8,it)]),_:1},8,["to","title"])])],2),e.project.teamName||e.project.teamDescription?(a(),r("hr",ut)):c("",!0),e.project.teamName||e.project.teamDescription?(a(),r("div",dt,[t("h2",null,o(l.$t("projectProfile.h2_4"))+" "+o(e.project.teamName),1),j(M,{raw:e.project.teamDescription||""},null,8,["raw"])])):c("",!0)]),e.previewMode?(a(),A(Pe,{key:2,project:e.project,class:"mt2"},null,8,["project"])):c("",!0)])):c("",!0)}});const kt=D(mt,[["__scopeId","data-v-b9068d8d"]]);export{Pe as L,kt as P,Ke as _};
